import{i as e}from"./index.umd.min-b551c2d1.js";import{d as l}from"./browser-564f0c02.js";import"./vue-echarts-bffdbdc9.js";import{a as r,b as t}from"./element-plus-cc31d756.js";import{a as o}from"./index-dd9d36be.js";import{u as i}from"./index-a1c3173c.js";import{v as s}from"./@vue.runtime-dom-532828a1.js";import"./store-acbd10e3.js";import{T as a}from"./@element-plus.icons-vue-2c9f4d7f.js";import{u as n}from"./component-59713cd5.js";import{d,e as p,W as u,_ as m,K as c,o as v,c as f,a as h,I as b,J as j,N as y,b as g,F as k,U as w,M as x,al as _,ak as C,q as z}from"./@vue.runtime-core-6173334e.js";import{r as T,u as I}from"./@vue.reactivity-54707199.js";import{p as W,L as q}from"./@vue.shared-0cc4c744.js";import{_ as F}from"./_plugin-vue_export-helper-1b428a4d.js";import{c as N}from"./lodash-es-fd5b777b.js";import"./axios-bb93cf32.js";import"./vue-21f38777.js";import"./monaco-editor-89e755bd.js";import"./nprogress-27d9be10.js";import"./vue-router-25454f45.js";import"./@vueuse.core-cb7ad152.js";import"./@vueuse.shared-feb01f08.js";import"./pinia-77f7f468.js";import"./vue-demi-71ba0ef2.js";import"./mockjs-005b47e8.js";import"./resize-detector-2312ef2b.js";import"./echarts-e550b62f.js";import"./tslib-a4e99503.js";import"./zrender-f72fb7be.js";import"./@popperjs.core-b696b006.js";import"./@ctrl.tinycolor-a951068a.js";import"./dayjs-f8876307.js";import"./async-validator-ff95bfc9.js";import"./memoize-one-63ab667a.js";import"./escape-html-1935ddb3.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui.dom-92665be4.js";import"./@floating-ui.core-c1b3624a.js";const M={class:"dict-group"},R={class:"head"},G=(e=>(_("data-v-221e20f3"),e=e(),C(),e))((()=>h("span",null,"类型",-1))),U={class:"list"},V=["onClick","onContextmenu"],E=d({name:"undefined"}),K=F(d({...E,emits:["refresh"],setup(o,{emit:d}){const{service:_}=i(),{ViewGroup:C}=n(),z=e.useForm(),F=T([]),N=T(!1);async function E(){N.value=!0,await _.dict.type.list({order:"createTime",sort:"asc"}).then((e=>{var l;F.value=e,(null==(l=C.value)?void 0:l.selected)||K()})),N.value=!1}function K(e){var l,r;e||(e=F.value[0]),e&&(d("refresh",{typeId:e.id,page:1}),null==(l=C.value)||l.select(e),null==(r=C.value)||r.setTitle(`字典列表（${e.name}）`))}function L(e){var l;null==(l=z.value)||l.open({title:e?"编辑类型":"添加类型",width:"500px",props:{labelWidth:"60px"},items:[{label:"名称",prop:"name",component:{name:"el-input",props:{maxlength:20}},required:!0},{label:"Key",prop:"key",component:{name:"el-input",props:{maxlength:20}},required:!0}],form:{...e},on:{submit(l,{close:t,done:o}){_.dict.type[e?"update":"add"](l).then((()=>{r.success("保存成功"),t(),E()})).catch((e=>{r.error(e.message),o()}))}}})}return p((()=>{E()})),(o,i)=>{const n=u("el-button"),d=u("el-icon"),p=u("el-empty"),T=u("el-scrollbar"),A=u("cl-form"),B=m("permission"),D=m("loading");return c((v(),f("div",M,[h("div",R,[G,c((v(),b(n,{type:"success",bg:"",size:"small",onClick:i[0]||(i[0]=e=>L())},{default:j((()=>[y("添加")])),_:1})),[[B,I(_).dict.type.permission.add]])]),h("div",U,[g(T,null,{default:j((()=>[h("ul",null,[(v(!0),f(k,null,w(F.value,((o,i)=>{var n,p,u,m;return v(),f("li",{key:i,class:W(["item",{"is-active":(null==(p=null==(n=I(C))?void 0:n.selected)?void 0:p.id)==o.id}]),onClick:e=>K(o),onContextmenu:i=>{!function(o,i){e.ContextMenu.open(o,{hover:{target:"item"},list:[{label:"编辑",hidden:!l(_.dict.type.permission.update),callback(e){e(),L(i)}},{label:"删除",hidden:!l(_.dict.type.permission.delete),callback(e){e(),t.confirm("是否要删除该类型？","提示",{type:"warning"}).then((()=>{_.dict.type.delete({ids:[i.id]}).then((async()=>{var e,l;r.success("删除成功"),await E(),(null==(l=null==(e=C.value)?void 0:e.selected)?void 0:l.id)==i.id&&K()})).catch((e=>{r.error(e.message)}))})).catch((()=>null))}}]})}(i,o)}},[h("span",null,q(o.name)+" - "+q(o.key),1),c(g(d,null,{default:j((()=>[g(I(a))])),_:2},1536),[[s,(null==(m=null==(u=I(C))?void 0:u.selected)?void 0:m.id)==o.id]])],42,V)})),128)),0==F.value.length?(v(),b(p,{key:0,"image-size":80})):x("",!0)])])),_:1})]),g(A,{ref_key:"Form",ref:z},null,512)])),[[D,N.value]])}}}),[["__scopeId","data-v-221e20f3"]]),L=d({name:"dict-list"}),A=d({...L,setup(l){const{service:r}=i(),{ViewGroup:t}=n(),s=e.useUpsert({dialog:{width:"600px"},props:{labelWidth:"100px"},items:[{label:"上级节点",prop:"parentId",component:{name:"el-tree-select",props:{data:z((()=>{var e;const l=N(null==(e=a.value)?void 0:e.data);return function e(l,r){var t;l.id&&l.id==(null==(t=s.value)?void 0:t.getForm("id"))&&(r=!0),r&&(l.disabled=!0),l.children&&l.children.forEach((l=>{e(l,r)}))}({children:l},!1),l})),props:{label:"name",value:"id",children:"children",disabled:"disabled"},clearable:!0,filterable:!0,"default-expand-all":!0,"check-strictly":!0}}},{label:"名称",prop:"name",required:!0,component:{name:"el-input"}},{label:"排序",prop:"orderNum",value:1,component:{name:"el-input-number",props:{min:1}}},{label:"备注",prop:"remark",component:{name:"el-input",props:{type:"textarea",rows:4}}}],onSubmit(e,{next:l}){var r,o;l({...e,typeId:null==(o=null==(r=t.value)?void 0:r.selected)?void 0:o.id})}}),a=e.useTable({contextMenu:["refresh",e=>{var l;return{label:"新增",hidden:!(null==(l=r.dict.info._permission)?void 0:l.add),callback(l){h(e),l()}}},"edit","delete","order-asc","order-desc"],columns:[{label:"名称",prop:"name",align:"left",minWidth:200},{label:"排序",prop:"orderNum",sortable:"desc",width:100},{label:"备注",prop:"remark",showOverflowTooltip:!0,minWidth:150},{label:"创建时间",prop:"createTime",sortable:"custom",minWidth:160},{label:"更新时间",prop:"updateTime",sortable:"custom",minWidth:160},{type:"op",width:250,buttons:["slot-btn","edit","delete"]}]}),d=e.useCrud({service:r.dict.info,onRefresh(e,{render:l}){r.dict.info.list({...e,page:void 0,size:void 0}).then((e=>{l(o(e))}))}});function p(e){var l;null==(l=d.value)||l.refresh(e)}function f(e,l){var r;(null==l?void 0:l.property)&&e.children&&(null==(r=a.value)||r.toggleRowExpansion(e))}function h(e){var l;null==(l=d.value)||l.rowAppend({parentId:e.id,orderNum:1})}return(e,l)=>{const o=u("cl-refresh-btn"),i=u("cl-add-btn"),n=u("cl-flex1"),k=u("cl-search-key"),w=u("cl-row"),x=u("el-button"),_=u("cl-table"),C=u("cl-upsert"),z=u("cl-crud"),T=u("cl-view-group"),W=m("permission");return v(),b(T,{ref_key:"ViewGroup",ref:t},{left:j((()=>[g(K,{onRefresh:p})])),right:j((()=>[g(z,{ref_key:"Crud",ref:d},{default:j((()=>[g(w,null,{default:j((()=>{var e;return[g(o),g(i,{disabled:!(null==(e=I(t))?void 0:e.selected)},null,8,["disabled"]),g(n),g(k)]})),_:1}),g(w,null,{default:j((()=>[g(_,{ref_key:"Table",ref:a,"row-key":"id",onRowClick:f},{"slot-btn":j((({scope:e})=>[c((v(),b(x,{text:"",bg:"",type:"success",onClick:l=>h(e.row)},{default:j((()=>[y("新增")])),_:2},1032,["onClick"])),[[W,I(r).dict.info.permission.add]])])),_:1},512)])),_:1}),g(w,null,{default:j((()=>[g(n)])),_:1}),g(C,{ref_key:"Upsert",ref:s},null,512)])),_:1},512)])),_:1},512)}}});export{A as default};
